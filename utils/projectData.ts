export const projectFiles = {
  "mimetype": "application/vnd.adobe.extension",
  
  "metadata.json": `{
  "name": "The Glez - Toolkit",
  "description": "A comprehensive suite of After Effects automation tools including Subtitle Pro, Project Organizer, and more.",
  "id": "com.theglez.toolkit",
  "version": "2.15.12",
  "requestFramePermissions": []
}`,

  "logo.svg": `<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 30.1.0, SVG Export Plug-In . SVG Version: 9.03 Build 0)  -->
<svg version="1.1" baseProfile="basic" id="Layer_1"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 800 800"
	 xml:space="preserve">
<style type="text/css">
	.st0{fill:#CEFF00;}
	.st1{fill:#282828;}
</style>
<path class="st0" d="M651.19,349.78c-0.79-9.26-12.64-20.52-15.6-22.57c-1.98-1.37-5.29-3.65-9.87-3.66c-0.01,0-0.02,0-0.03,0
	c-12.97,0-38.94,17.25-39.2,17.42c-0.8,0.54-1.61,1.09-2.41,1.65c4.09-6.78,8.17-13.56,12.19-20.37c6.04-13.28,2.5-20.92-4.07-32.67
	c-5.67-10.15-19-32.26-31.02-33.67c-14.52-1.71-52.67,12.44-68,17.69c-6.49,2.22-17.83,7.9-23.68,8.99
	c-3.99,0.75-8.32,0.22-12.99,1.11c-2.79,0.53-5.79,1.21-8.9,2.01c0.53-0.79,0.95-1.66,1.26-2.58c1.59-4.79,0.74-10.43-2.27-15.07
	c-1.09-1.68-2.4-3.12-3.88-4.28c0.37-0.66,0.68-1.38,0.93-2.16c0.11-0.33,0.2-0.66,0.27-1c1.16-5.15-0.15-10.46-3.34-14.66
	c0.57-0.1,1.14-0.2,1.71-0.31c3.16-0.6,5.89-2.57,7.46-5.38c2.76-4.98,2.81-10.66,0.13-15.59c-1.34-2.46-3.32-4.6-5.69-6.26
	c3.27-0.89,6.24-1.89,8.66-3.06c8.8-4.29,10.87-11.78,9.88-17.36c-1.4-7.85-8.68-13.76-18.1-14.7c0,0,0,0,0,0
	c-11.66-1.16-27.82,3.53-38.52,6.64l-1.02,0.3c-31.07,9.02-64.47,23.47-94.05,40.71c-0.3,0.17-0.68,0.4-1.14,0.66
	c-16.32,9.45-18.97,11.65-20.82,14.13c-3.78,5.08-3.67,12.05,0.29,18.66c3.43,5.71,9.78,11.41,17.31,10.26
	c3.38-0.52,6.41-2.37,14.88-7.97l-5.35,23.68c-2.83,8.86,4.99,17.44,10.55,21.44c-1.59,2.14-2.99,4.68-4.13,7.64l-1.27,0.41
	c-6.02-10.49-15.4-20.15-25.68-26.53c-8.23-5.1-16.39-9.62-26.34-7.23c-20.67,4.96-47.47,35.28-59.69,52.41
	c-27.7,38.84-53.86,103.88-50.99,152.05c2.32,38.8,42.15,82.02,83.4,69.96c1.4-0.41,9.72-4.03,10.1-3.66
	c-2.62,5.77-6.61,9.86-7.52,16.5c-2.74,20.05,20.23,40.73,39.86,38.58c19.54-6.69,37.61-17.27,56.72-25.27
	c50.38-21.1,107.26-34.17,161.72-39.41c10.74-1.03,25.66,0.29,35.1-4.61c15.99-8.3,18.26-35.37,9.52-49.63l-5.87-9.17
	c10.42-2.52,20.66-5.64,31.25-7.5c13.97-2.46,28.43-0.49,36.92-14.32c9.56-15.56-5.32-43.53-15.96-55.69
	c-4.79-5.47-9.5-8.45-14.43-9.84c14-10.39,27.62-20.07,43.99-27.34c1.08-0.48,4.98-1.94,8.43-3.24c13.34-5.01,14.39-5.47,16.05-7.09
	C650.34,356.54,651.49,353.31,651.19,349.78z M384.43,315.46c-0.1,0.16-0.21,0.32-0.31,0.48c-0.01-0.05-0.01-0.09-0.02-0.14
	c0.08-0.09,0.16-0.17,0.24-0.26C384.38,315.52,384.4,315.49,384.43,315.46z M377.38,303.2c-0.02,0.02-0.04,0.05-0.06,0.07
	c0-0.03,0-0.06,0.01-0.09C377.35,303.19,377.37,303.2,377.38,303.2z"/>
<g>
	<g>
		<g>
			<path class="st0" d="M443.56,194.1c-9.92-0.99-25.7,3.74-35.45,6.57c-31.03,9.01-63.73,23.42-91.62,39.67
				c-3.28,1.91-17.2,9.85-18.73,11.91c-2.71,3.63,4.04,12.26,7.3,11.77c2.02-0.31,12.8-7.97,15.8-9.67
				c2.19-1.24,15.32-8.48,16.34-7.72l-10.58,46.82c-1.57,3.51,8.6,12.86,10.57,10.94l13.59-64.75
				c20.83-10.81,43.26-19.59,65.87-26.03c8.42-2.4,24.55-4.57,31.45-7.93C455.73,201.96,451.62,194.9,443.56,194.1z"/>
		</g>
	</g>
	<g>
		<g>
			<path class="st0" d="M388.18,234.55l-4.98,25.23c-0.5,0.79-10.61,3.21-12.33,3.44c-1.41,0.19-1.42,0.2-1.15-1.15
				c1.88-9.32,9.4-23.83-7.04-21.49l-9.64,46.87c-1.17,6.72,6.99,9.46,12.18,10.8l2.69-21.38l13.07-3.99
				c-1.26,9.79-3.68,20.05,9.55,20.92l8.43-55.03C396.26,235.53,392.39,232.73,388.18,234.55z"/>
		</g>
	</g>
	<g>
		<g>
			<path class="st0" d="M433.03,225.55c-3.13-0.21-23.36,5.97-24.5,7.92c-1.5,9.7-4.59,19.06-6.3,28.71
				c-0.81,4.58-2.93,15.03-2.9,19.03c0.03,3.3,5.92,11.69,9.86,10.76l29.41-12.24c1.04-3.13-1.48-8.08-4.8-8.41
				c-3.25-0.33-20.44,8.56-22.19,6.79c-0.02-0.72-0.05-1.46-0.03-2.19c0.04-1.5,1.38-9.13,1.98-9.85c1.84-2.18,18.78-4.63,19.81-7.8
				c0.75-3.34-1.21-6.38-4.01-8.03l-13.38,4.24l3.08-13.98c6.48-3.66,14.1-4.12,21.22-5.46
				C442.99,230.2,437.81,225.87,433.03,225.55z"/>
		</g>
	</g>
</g>
<g>
	<path class="st1" d="M630.8,334.15c-1.53-1.05-3.14-2.17-5.1-2.17c-7.95-0.01-27.53,11.29-34.5,15.99
		c-12.15,8.18-26.58,20.25-36.19,31.28c-2.75,3.16-8.17,9.07-7.99,13.3c0.34,7.99,4.48,10.52,12.18,8.53
		c20.24-14.75,37.68-29.3,60.85-39.59c3.27-1.45,21.16-7.83,22.01-8.66C645.84,349.15,634.15,336.47,630.8,334.15z"/>
	<path class="st1" d="M575.28,407.08c-14.73,0.15-29.21,4.02-43.82,5.7c6.24-11.51,12.55-23.04,19.11-34.37
		c10.9-18.84,24.31-38.29,34.17-57.43c6.5-12.61,5.27-14.94-1.51-26.89c-7-12.32-15.63-29.65-31.92-26.4
		c-16.17,3.22-37.04,10.81-53,16.17c-8.58,2.89-17.66,5.66-25.93,9.3c-5,2.2-4.42,0.79-9.79,1.1c-11.95,0.71-34.76,9.22-46.4,13.8
		c-4.51,1.78-11.44,4.08-15.42,6.36c-10.85,6.23-4.1,19.27-9.61,23.7c-7.31,5.87-12-8.75-15.63-12.48
		c-9.28-9.53-37.08-20.71-42.81-2.41c-1.26,4.01-1.3,16.47-5.39,17.68c-5.95,1.77-7.67-6.04-9.91-9.68
		c-11.26-18.24-31.8-42.3-55.63-30.25c-23.05,11.65-45.09,42.33-57.73,64.61c-19.81,34.88-43.52,102.4-31.24,141.63
		c7.44,23.75,34.17,48.27,60.42,45.13c7.7-0.92,13-7.66,19.89-10.21c3.9,2.47,6.39,6.41,10.4,8.89c2.4,1.49,5.86,2.28,7.88,3.65
		c0.62,0.42,0.91,0.46,0.3,0.94c-6.2,4.89-16.34,12.23-16.36,20.83c-0.02,13.04,9.96,21.33,21.39,25.42
		c7.33,2.62,13.21-1.62,19.89-4.69c10.12-4.66,19.91-10.17,30.08-14.75c53.84-24.29,118.59-40.38,177.54-45.36
		c16.11-1.36,34.51,3.1,37.94-18.42c1.57-9.86-0.43-17.83-6.9-25.44c-6.89-8.1-12.46-8.1-21.76-10.91
		c-0.61-0.18-1.46-0.11-1.27-0.95c22.15-5.28,45.01-13.69,67.58-16.65c2.2-0.29,4.64,0.18,6.96-0.09
		c23.22-2.67,16.76-24.19,8.6-38.55C591.33,418.89,583.99,408.24,575.28,407.08z M386.37,425.59c3.03-14.31,6.34-28.65,9.61-42.91
		c2.07-9.03,10.63-36.65,9.77-43.7c-0.5-4.1-4.6-9.93-3.7-13.51c0.12-0.47,7.4-3.84,8.56-4.38c16.6-7.82,34.68-12.49,52.49-16.45
		c2.63,0.69,9.54,14.92,10.28,17.96c0.27,1.14,0.74,1.85,0.14,3.08c-1.86,3.8-33.28,12.33-38.44,16.03l-8.65,32.01l23.87-9.52
		c4.85,3.35,11.1,11.94,9.92,18.04c-0.41,2.12-5.39,4.96-7.4,6.02c-9.99,5.26-22.21,7.65-32.2,13.28
		c-4.91,13.69-7.96,27.91-11.49,41.99l38.73-19.14c5.51-0.13,10.53,14.11,9.17,18.69c-0.46,1.56-5.19,4.97-6.71,6.1
		c-14.72,10.88-31.88,19.7-46.36,31.14c-5.68,2.86-7.48,1.9-12.14-1.87c-4.02-3.26-10.6-9.75-11.36-14.91
		C379.09,454.14,384.27,435.52,386.37,425.59z M327.45,391.01c2.69-11.72,7.02-23.01,9.64-34.56c1.98-8.75,2.43-19.05,4.55-27.47
		c2.07-8.2,8.23-5.32,14.11-2.77c4.12,1.79,12.36,6.3,12.38,11.31c-8.13,44.38-21.41,87.57-30.74,131.64
		c6.59-3.86,12.77-8.51,19.42-12.28c2.94-1.67,11.49-6.75,14.33-6.76c5.46-0.02,10.18,13,8.19,17.74
		c-1,2.39-18.82,13.98-22.39,16.68c-5.91,4.47-11.32,9.74-17.43,13.96c-3.44,2.37-10.24,7.57-14.33,6.24
		c-2.07-0.67-13.51-11.69-14.98-13.85c-0.94-1.38-2.03-3.96-2.16-5.59c-0.36-4.62,2.84-17.36,3.9-22.68
		C316.68,438.81,322.02,414.66,327.45,391.01z M263.1,536.71c-2.29-1.85-3.31-6.72-3.28-9.58c0.01-1.35,0.66-2.62,0.69-3.85
		c0.17-8.53,0.61-16.29,2.56-24.65c-15.53,18.02-32.31,47.44-60.15,31.01c-33.98-20.05-24.3-67.4-15.1-98.91
		c10.28-35.18,28.29-72.77,53.15-99.93c7.71-8.42,26.61-24.46,38.64-21.33c5.48,1.43,9.39,6.92,13.23,10.47
		c2.93,2.7,6.81,3.51,7.88,8.78c2.34,11.54-3.56,32.69-9.22,43.01c-1.54,2.81-3.25,6.72-7.28,4.87c-1.82-0.84-10.28-9.39-10.22-12.2
		l3.16-21.08l-2.86-2.89c-6.02,7.85-12.38,15.41-18.39,23.27c-23.02,30.11-38.12,64.15-45.7,101.62c-3,14.82-5.44,31.97,0.98,46.12
		c0.49,0.37,7.47-4.49,8.52-5.24c14.96-10.73,30.67-30.37,40.42-46.05c3.32-5.35,6.04-12.33,9.44-17.46
		c1.07-1.61,5.26-5.59,5.66-6.52c0.34-0.78-0.14-1.2-0.94-0.94c-6.1,1.99-13.77,8.37-19.53,9.94c-2.15,0.58-3.76,0.48-5.47-0.97
		c-2.38-2.02-9.86-15.88-9.95-18.93c-0.1-3.4,2.09-4.72,4.72-6.17c14.59-8.05,41.99-19.3,58.09-23.26c2.3-0.57,5.92-2.1,7.61,0.06
		c3.3,4.22,4.55,11.28,3.84,16.52c-13.22,41.25-23.18,83.49-28.41,126.6c-1.04,2.49-3.1,3.42-5.72,3.15
		C277.15,541.91,264.74,538.03,263.1,536.71z M528.84,507.85c-0.36,12.03-17.27,9.9-25.23,10.63
		c-73.45,6.79-145.47,23.02-210.85,57.53c-3.99,2.11-12.76,8.38-16.19,9.43c-3.25,0.99-6.54-0.07-8.78-2.49
		c-5.86-6.35,1.22-12.21,5.88-16.42c36.4-32.83,112.31-57.38,160.32-65.79c21.84-3.83,54.28-8.66,76.05-7.28
		C518.79,494.02,529.16,497.03,528.84,507.85z M587.36,442.73c-0.63,1.48-2.98,2.28-4.49,2.58c-6.71,1.32-14.43,1.64-21.43,2.91
		c-28.14,5.14-56.37,13.52-82.85,24.16c-2.4,0.14-3.02-0.3-4.8-1.61c-2.93-2.18-12.68-12.22-13.29-15.53
		c-1.03-5.62,3.73-15.23,5.95-20.65c7.29-17.77,16.55-36.23,25.59-53.2c12.19-22.91,25.56-46.38,41.32-66.92l-40.01,11.2
		c-3.11-0.6-7.01-10.02-8.79-13c-2.12-3.53-4.76-6.77-6.89-10.3c1-1.55,2.7-2.12,4.29-2.8c10-4.28,23.62-7.87,34.26-11.21
		c10.95-3.44,23.95-8.09,34.94-10.53c4.04-0.9,5.43-1.43,8.81,1.71c2.82,2.62,11.57,16.18,12.32,19.7c0.25,1.18,0.33,2.37-0.01,3.55
		c-6.06,10.03-12.93,19.69-18.95,29.73c-16.73,27.9-34.33,57.73-49.14,86.65c-2.45,4.78-4.82,9.72-6.69,14.76
		c21.23-7.42,43.38-13.01,65.75-15.91c4.28-0.55,9.24-1.91,13.05,0.83C579.95,421.46,589.06,438.75,587.36,442.73z"/>
	<path class="st1" d="M305.06,264.01c2.02-0.31,12.8-7.97,15.8-9.67c2.19-1.24,15.32-8.48,16.34-7.72l-10.58,46.82
		c-1.57,3.51,8.6,12.86,10.57,10.94l13.59-64.75c20.83-10.81,43.26-19.59,65.87-26.03c8.42-2.4,24.55-4.57,31.45-7.93
		c7.61-3.71,3.5-10.76-4.56-11.57c-9.92-0.99-25.7,3.74-35.45,6.57c-31.03,9.01-63.73,23.42-91.62,39.67
		c-3.28,1.91-17.2,9.85-18.73,11.91C295.05,255.87,301.8,264.5,305.06,264.01z"/>
	<path class="st1" d="M390.52,293.79l8.43-55.03c-2.68-3.23-6.55-6.03-10.77-4.21l-4.98,25.23c-0.5,0.79-10.61,3.21-12.33,3.44
		c-1.41,0.19-1.42,0.2-1.15-1.15c1.88-9.32,9.4-23.83-7.04-21.49l-9.64,46.87c-1.17,6.72,6.99,9.46,12.18,10.8l2.69-21.38
		l13.07-3.99C379.71,282.66,377.28,292.92,390.52,293.79z"/>
	<path class="st1" d="M440.29,235.05c2.69-4.85-2.48-9.18-7.26-9.5c-3.13-0.21-23.36,5.97-24.5,7.92c-1.5,9.7-4.59,19.06-6.3,28.71
		c-0.81,4.58-2.93,15.03-2.9,19.03c0.03,3.3,5.92,11.69,9.86,10.76l29.41-12.24c1.04-3.13-1.48-8.08-4.8-8.41
		c-3.25-0.33-20.44,8.56-22.19,6.79c-0.02-0.72-0.05-1.46-0.03-2.19c0.04-1.5,1.38-9.13,1.98-9.85c1.84-2.18,18.78-4.63,19.81-7.8
		c0.75-3.34-1.21-6.38-4.01-8.03l-13.38,4.24l3.08-13.98C425.55,236.85,433.17,236.39,440.29,235.05z"/>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>`,

  "CSXS/manifest.xml": `<?xml version="1.0" encoding="UTF-8"?>
<ExtensionManifest Version="9.0" ExtensionBundleId="com.theglez.toolkit" ExtensionBundleVersion="2.15.12" ExtensionBundleName="The Glez - Toolkit"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ExtensionList>
    <Extension Id="com.theglez.toolkit.panel" Version="2.15.12" />
  </ExtensionList>
  <ExecutionEnvironment>
    <HostList>
      <Host Name="AEFT" Version="[14.0,99.9]" />
    </HostList>
    <LocaleList>
      <Locale Code="All" />
    </LocaleList>
    <RequiredRuntimeList>
      <RequiredRuntime Name="CSXS" Version="9.0" />
    </RequiredRuntimeList>
  </ExecutionEnvironment>
  <DispatchInfoList>
    <Extension Id="com.theglez.toolkit.panel">
      <DispatchInfo >
        <Resources>
          <MainPath>./index.html</MainPath>
          <ScriptPath>./host/index.jsx</ScriptPath>
          <CEFCommandLine>
            <Parameter>--enable-nodejs</Parameter>
            <Parameter>--mixed-context</Parameter>
            <Parameter>--enable-media-stream</Parameter>
            <Parameter>--disable-web-security</Parameter>
          </CEFCommandLine>
        </Resources>
        <Lifecycle>
          <AutoVisible>true</AutoVisible>
        </Lifecycle>
        <UI>
          <Type>Panel</Type>
          <Menu>The Glez - Toolkit</Menu>
          <Geometry>
            <Size>
              <Height>600</Height>
              <Width>400</Width>
            </Size>
            <MinSize>
              <Height>300</Height>
              <Width>300</Width>
            </MinSize>
          </Geometry>
        </UI>
      </DispatchInfo>
    </Extension>
  </DispatchInfoList>
</ExtensionManifest>`,

  "index.html": `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://unpkg.com https://cdnjs.cloudflare.com data:;">
    <title>The Glez - Toolkit</title>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              glez: { dark: '#18181b', card: '#27272a', lime: '#ccff00', limeHover: '#b3e600' }
            },
            fontFamily: { sans: ['Inter', 'sans-serif'] }
          }
        }
      }
    </script>

    <!-- React UMD -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-glez-dark text-white overflow-hidden">
    <div id="root"></div>

    <!-- CSInterface Shim -->
    <script>
      (function(){var n=function(){};n.prototype.getHostEnvironment=function(){return JSON.parse(window.__adobe_cep__.getHostEnvironment())},n.prototype.closeExtension=function(){window.__adobe_cep__.closeExtension()},n.prototype.getSystemPath=function(n){var e=decodeURIComponent(window.__adobe_cep__.getSystemPath(n)),t=navigator.platform.toLowerCase().indexOf("win")>-1;return t?e.replace(/^file:\\/\\//,""):e.replace(/^file:\\/\\//,"/")},n.prototype.evalScript=function(n,e){null==e&&(e=function(n){}),window.__adobe_cep__.evalScript(n,e)},n.prototype.openURLInDefaultBrowser=function(n){return window.__adobe_cep__.openURLInDefaultBrowser(n)},window.CSInterface=n})();
      if (typeof window.__adobe_cep__ === 'undefined') {
        window.CSInterface = function() {};
        window.CSInterface.prototype.evalScript = function(s) { console.log("[AE Call]", s); };
        window.CSInterface.prototype.openURLInDefaultBrowser = function(u) { window.open(u, '_blank'); };
        window.CSInterface.prototype.getSystemPath = function() { return ""; };
      }
      
      window.onerror = function(msg, url, line) {
        // Suppress benign resize errors often seen in CEP
        if (msg && msg.indexOf("ResizeObserver") > -1) return;
        alert("UI Error: " + msg + "\\nLine: " + line);
      };
    </script>

    <!-- React App -->
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        // Icons
        const ZapIcon = ({size, fill, className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill={fill || "none"} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
        );
        const InfoIcon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        );
        const TypeIcon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" y1="20" x2="15" y2="20"/><line x1="12" y1="4" x2="12" y2="20"/></svg>
        );
        const MaximizeIcon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3"/><path d="M21 8V5a2 2 0 0 0-2-2h-3"/><path d="M3 16v3a2 2 0 0 0 2 2h3"/><path d="M16 21h3a2 2 0 0 0 2-2v-3"/></svg>
        );
        const Trash2Icon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
        );
        const PenToolIcon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19 7-7 3 3-7 7-3-3z"/><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="m2 2 7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg>
        );
        const FolderInputIcon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 9V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H2"/><path d="M12 13v8"/><path d="m9 16 3-3 3 3"/></svg>
        );
        const PaletteIcon = ({size}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/></svg>
        );

        const runAeScript = (functionName) => {
          try {
            const csInterface = new window.CSInterface();
            
            // 1. Get Extension Path safely
            var extPath = csInterface.getSystemPath('extension');
            if (!extPath) { 
                console.log("Mock executing: " + functionName);
                return; 
            }

            // 2. Decode & Normalize Slashes
            extPath = decodeURIComponent(extPath);
            var cleanPath = extPath.split("\\\\").join("/");
            
            if (cleanPath.indexOf("file://") === 0) {
                cleanPath = cleanPath.substring(7);
            }
            if (/^\\/[a-zA-Z]:\\//.test(cleanPath)) {
                cleanPath = cleanPath.substring(1);
            }

            // 3. Robust Command Construction using Concatenation
            var scriptPath = cleanPath + "/host/index.jsx";
            
            var cmd = "try { ";
            cmd += "var f = new File('" + scriptPath + "'); ";
            cmd += "if (typeof $._TheGlez === 'undefined') { ";
            cmd +=     "if (f.exists) { $.evalFile(f); } ";
            cmd +=     "else { alert('Host script missing: ' + f.fsName); } ";
            cmd += "} ";
            cmd += "if (typeof $._TheGlez !== 'undefined' && typeof $._TheGlez['" + functionName + "'] === 'function') { ";
            cmd +=     "$._TheGlez['" + functionName + "'](); ";
            cmd += "} else { ";
            cmd +=     "alert('Function " + functionName + " not found.'); ";
            cmd += "} ";
            cmd += "} catch(e) { alert('Exec Error: ' + e.toString()); }";

            csInterface.evalScript(cmd);
          } catch(e) { alert("Interface Error: " + e.message); }
        };

        const tools = [
          { id: 'subtitle-pro', name: 'Subtitle Pro', description: 'Create subs from SRT.', icon: TypeIcon, functionName: 'runSubtitlePro' },
          { id: 'resize-comp', name: 'Resize Comp', description: 'Crop comp to layer.', icon: MaximizeIcon, functionName: 'runResizeComp' },
          { id: 'unused-cleaner', name: 'Clean Unused', description: 'Delete unused items.', icon: Trash2Icon, functionName: 'runUnusedCleaner' },
          { id: 'layer-renamer', name: 'Renamer', description: 'Batch rename layers.', icon: PenToolIcon, functionName: 'runRenamer' },
          { id: 'project-organizer', name: 'Organizer', description: 'Sort into folders.', icon: FolderInputIcon, functionName: 'runOrganizer' },
          { id: 'auto-type-color', name: 'Auto Color', description: 'Label by type.', icon: PaletteIcon, functionName: 'runAutoColor' }
        ];

        const App = () => {
          const [hoveredId, setHoveredId] = useState(null);
          
          return (
            <div className="min-h-screen flex flex-col p-3 bg-glez-dark selection:bg-glez-lime selection:text-black">
              {/* Header */}
              <header className="mb-4 relative h-32 flex items-center justify-center border-b border-white/10 shrink-0">
                
                {/* Center: Logo */}
                <div className="h-32 w-auto transition-transform duration-300 hover:scale-105">
                    <img 
                        src="./logo.svg" 
                        alt="The Glez" 
                        className="h-full w-full object-contain"
                    />
                </div>

                {/* Right: Actions */}
                <div className="absolute right-0 flex items-center gap-2">
                     <div className="text-[9px] font-mono uppercase tracking-widest text-zinc-500 text-right leading-tight">
                        Plugin By<br/>- The Glez V2.15.12
                     </div>
                     <div className="p-1.5 rounded-full text-zinc-500"><InfoIcon size={16} /></div>
                </div>
              </header>

              {/* Grid - 3 Columns for smaller buttons */}
              <main className="flex-1 grid grid-cols-3 gap-2 content-start pb-2">
                {tools.map((tool) => {
                    const Icon = tool.icon;
                    return (
                      <button key={tool.id} onClick={() => runAeScript(tool.functionName)} onMouseEnter={() => setHoveredId(tool.id)} onMouseLeave={() => setHoveredId(null)}
                        className="group relative flex flex-col items-start p-2 rounded-lg border border-zinc-700/50 bg-glez-card transition-all duration-300 ease-out hover:border-glez-lime hover:shadow-[0_0_15px_rgba(204,255,0,0.1)] hover:-translate-y-0.5 h-24 overflow-hidden">
                        
                        <div className="flex items-start justify-between w-full mb-1">
                            <div className="p-1.5 rounded bg-zinc-800 transition-colors duration-300 group-hover:bg-glez-lime group-hover:text-black text-zinc-300">
                                <Icon size={18} />
                            </div>
                            <div className="opacity-0 group-hover:opacity-100 transition-opacity duration-300 text-glez-lime">
                                <ZapIcon size={12} fill="currentColor" />
                            </div>
                        </div>

                        <div className="text-left z-10 w-full">
                            <h3 className="text-xs font-bold text-white group-hover:text-glez-lime transition-colors truncate">{tool.name}</h3>
                            <p className="text-[9px] text-zinc-400 mt-0.5 leading-tight line-clamp-2 opacity-80">{tool.description}</p>
                        </div>
                        
                        <div className="absolute inset-0 rounded-lg bg-gradient-to-br from-glez-lime/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none" />
                      </button>
                    );
                })}
              </main>

              {/* Footer */}
              <footer className="mt-auto pt-2 border-t border-white/5 text-center"><p className="text-[8px] text-zinc-600 uppercase tracking-widest">Designed for professional workflows</p></footer>
            </div>
          );
        };
        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>`,

  "host/index.jsx": `// Clean Namespace Initialization
if (typeof $._TheGlez === 'undefined') {
    $._TheGlez = {};
}

// --- SUBTITLE PRO ---
$._TheGlez.runSubtitlePro = function() {
    var scriptName = "Subtitle Pro";
    
    function rgbToHex(r, g, b) { var toHex = function(c) { var hex = Math.round(c * 255).toString(16); return hex.length == 1 ? "0" + hex : hex; }; return toHex(r) + toHex(g) + toHex(b); }
    function hexToRgb(hex) { if (typeof hex !== 'string') return [1,1,1]; hex = hex.replace(/[^0-9A-Fa-f]/g, ""); if (hex.length === 3) hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]; if (hex.length !== 6) return [1,1,1]; var r = parseInt(hex.substring(0,2), 16) / 255; var g = parseInt(hex.substring(2,4), 16) / 255; var b = parseInt(hex.substring(4,6), 16) / 255; return [r, g, b]; }
    function parseTime(str) { var parts = str.replace(',', '.').split(':'); if (parts.length < 3) return 0; return (parseInt(parts[0])*3600) + (parseInt(parts[1])*60) + parseFloat(parts[2]); }

    var win = new Window("palette", scriptName, undefined, {resizeable: true});
    win.orientation = "column"; win.alignChildren = ["fill", "top"]; win.spacing = 10; win.margins = 16;
    
    var headerGrp = win.add("group"); headerGrp.orientation = "row";
    var title = headerGrp.add("statictext", undefined, "SUBTITLE PRO");
    
    var pnlFile = win.add("panel", undefined, "SRT File"); pnlFile.orientation = "column"; pnlFile.alignChildren = ["fill", "top"]; pnlFile.margins = 12;
    var grpFileRow = pnlFile.add("group"); grpFileRow.orientation = "row";
    var btnLoad = grpFileRow.add("button", undefined, "Import .SRT"); btnLoad.size = [120, 30];
    var lblFile = grpFileRow.add("statictext", undefined, "No file...", {truncate: "middle"}); lblFile.size = [150, 20];

    var pnlStyle = win.add("panel", undefined, "Style"); pnlStyle.orientation = "column"; pnlStyle.alignChildren = ["fill", "top"]; pnlStyle.spacing = 10; pnlStyle.margins = 12;
    var grpColor = pnlStyle.add("group"); grpColor.orientation = "row"; grpColor.add("statictext", undefined, "Color:");
    var colorBtn = grpColor.add("button", [0,0,30,25], ""); var currentColor = [1, 1, 1];
    var inpHex = grpColor.add("edittext", undefined, "FFFFFF"); inpHex.characters = 6;
    
    colorBtn.onDraw = function() { var g = this.graphics; g.rectPath(0,0,this.size[0],this.size[1]); g.fillPath(g.newBrush(g.BrushType.SOLID_COLOR, currentColor)); g.strokePath(g.newPen(g.PenType.SOLID_COLOR, [0,0,0], 1)); }; 
    colorBtn.onClick = function() { var r = Math.round(currentColor[0] * 255); var g = Math.round(currentColor[1] * 255); var b = Math.round(currentColor[2] * 255); var colorInt = (r << 16) | (g << 8) | b; var result = $.colorPicker(colorInt); if (result !== -1) { var nr = ((result >> 16) & 0xFF) / 255; var ng = ((result >> 8) & 0xFF) / 255; var nb = (result & 0xFF) / 255; currentColor = [nr, ng, nb]; colorBtn.notify("onDraw"); inpHex.text = rgbToHex(nr, ng, nb).toUpperCase(); } };
    inpHex.onChange = function() { currentColor = hexToRgb(this.text); colorBtn.notify("onDraw"); };

    var grpTypo = pnlStyle.add("group"); grpTypo.orientation = "row"; grpTypo.add("statictext", undefined, "Size:"); var inpSize = grpTypo.add("edittext", undefined, "30"); inpSize.characters = 4; grpTypo.add("statictext", undefined, "Break:"); var inpBreak = grpTypo.add("edittext", undefined, "50"); inpBreak.characters = 4;
    var grpChecks = pnlStyle.add("group"); grpChecks.orientation = "row"; var chkCaps = grpChecks.add("checkbox", undefined, "UPPERCASE"); var chkStroke = grpChecks.add("checkbox", undefined, "Stroke");
    var pnlAnim = win.add("panel", undefined, "Animation"); pnlAnim.orientation = "column"; pnlAnim.alignChildren = ["fill", "top"]; var grpAnim = pnlAnim.add("group"); grpAnim.orientation = "row"; grpAnim.add("statictext", undefined, "Preset:"); var ddAnim = grpAnim.add("dropdownlist", undefined, ["Pop Up", "Fade In", "Slide Up", "Typewriter"]); ddAnim.selection = 0; var grpPos = pnlAnim.add("group"); grpPos.add("statictext", undefined, "Position Y:"); var sldPos = grpPos.add("slider", undefined, 92, 0, 100);

    var btnRun = win.add("button", undefined, "GENERATE SUBTITLES"); btnRun.size = [undefined, 45];
    var srtContent = "";
    btnLoad.onClick = function() { var f = File.openDialog("Select SRT File"); if (f) { f.open("r"); srtContent = f.read(); f.close(); lblFile.text = f.name; } };

    btnRun.onClick = function() {
        if (!srtContent) { alert("Import an SRT file first."); return; }
        app.beginUndoGroup("Subtitle Pro Gen");
        try {
            var comp = app.project.activeItem;
            if (!comp || !(comp instanceof CompItem)) comp = app.project.items.addComp("Subtitles Sequence", 1080, 1920, 1, 60, 30);
            var config = { size: parseInt(inpSize.text), color: currentColor, y: comp.height * (sldPos.value / 100), caps: chkCaps.value, stroke: chkStroke.value, wrap: parseInt(inpBreak.text), anim: ddAnim.selection ? ddAnim.selection.text : "Pop Up" };
            // FIX: Double escaped regex for ZXP file write safety
            var blocks = srtContent.replace(/\\r\\n/g, "\\n").split("\\n\\n");
            var wrapText = function(text, limit) { var words = text.split(" "); var lines = [], cur = ""; for (var i=0; i<words.length; i++) { if ((cur + words[i]).length > limit) { if(cur.length>0) lines.push(cur); cur = words[i] + " "; } else cur += words[i] + " "; } if(cur.length>0) lines.push(cur); return lines.join("\\r"); };
            
            for (var i=0; i<blocks.length; i++) {
                var lines = blocks[i].split("\\n");
                if (lines.length >= 3) {
                    var timePart = lines[1].split(" --> ");
                    if (timePart.length === 2) {
                        var rawTxt = lines.slice(2).join(" "); if (config.caps) rawTxt = rawTxt.toUpperCase(); var finalTxt = wrapText(rawTxt, config.wrap);
                        var l = comp.layers.addText(finalTxt); var doc = l.property("Source Text").value;
                        doc.fontSize = config.size; doc.fillColor = config.color; doc.justification = ParagraphJustification.CENTER_JUSTIFY;
                        if (config.stroke) { doc.applyStroke = true; doc.strokeColor = [0,0,0]; doc.strokeWidth = 10; }
                        l.property("Source Text").setValue(doc); l.property("Position").setValue([comp.width/2, config.y]);
                        l.inPoint = parseTime(timePart[0]); l.outPoint = parseTime(timePart[1]);
                        var st = l.inPoint;
                        
                        if (config.anim === "Pop Up") { l.property("Scale").setValueAtTime(st, [0,0]); l.property("Scale").setValueAtTime(st+0.15, [110,110]); l.property("Scale").setValueAtTime(st+0.25, [100,100]); }
                        else if (config.anim === "Fade In") { l.property("Opacity").setValueAtTime(st, 0); l.property("Opacity").setValueAtTime(st+0.3, 100); }
                        else if (config.anim === "Slide Up") { var p = l.property("Position").value; l.property("Position").setValueAtTime(st, [p[0], p[1]+100]); l.property("Position").setValueAtTime(st+0.3, p); l.property("Opacity").setValueAtTime(st, 0); l.property("Opacity").setValueAtTime(st+0.3, 100); }
                        else if (config.anim === "Typewriter") { var anim = l.Text.Animators.addProperty("ADBE Text Animator"); var op = anim.property("ADBE Text Animator Properties").addProperty("ADBE Text Opacity"); op.setValue(0); var sel = anim.property("ADBE Text Selectors").addProperty("ADBE Text Selector"); sel.property("Start").setValueAtTime(st, 0); sel.property("Start").setValueAtTime(st + (finalTxt.length * 0.05), 100); }
                    }
                }
            }
        } catch(e) { alert("Error: " + e.toString()); } finally { app.endUndoGroup(); }
    };
    win.center(); win.show();
}

// --- RESIZE COMP ---
$._TheGlez.runResizeComp = function() {
    if (!app || !app.project) { alert("No project open."); return; }
    var proj = app.project; var comp = proj.activeItem;
    if (!(comp instanceof CompItem)) { alert("Please select a composition."); return; }
    if (!comp.selectedLayers || comp.selectedLayers.length !== 1) { alert("Select ONE layer."); return; }
    var layer = comp.selectedLayers[0];
    
    function getBounds2D(lyr, time) {
        var rect; try { rect = lyr.sourceRectAtTime(time, false); } catch (e) { rect = null; }
        if (!rect) { var w = lyr.width || 0; var h = lyr.height || 0; rect = { left: 0, top: 0, width: w, height: h }; }
        var pos = lyr.property("Position").value; var anchor = lyr.property("Anchor Point").value; var scale = lyr.property("Scale").value;
        var sx = scale[0] / 100.0; var sy = scale[1] / 100.0;
        var compLeft = pos[0] + (rect.left - anchor[0]) * sx; var compTop = pos[1] + (rect.top - anchor[1]) * sy;
        return { minX: compLeft, maxX: compLeft + (rect.width * sx), minY: compTop, maxY: compTop + (rect.height * sy) };
    }
    
    var bounds = getBounds2D(layer, comp.time);
    var newWidth = Math.round(bounds.maxX - bounds.minX); var newHeight = Math.round(bounds.maxY - bounds.minY);
    if (newWidth < 1 || newHeight < 1) { alert("Layer too small."); return; }
    app.beginUndoGroup("Resize Comp - The Glez");
    var offsetX = bounds.minX; var offsetY = bounds.minY;
    for (var i = 1; i <= comp.numLayers; i++) {
        var lyr = comp.layer(i); var posProp = lyr.property("Position");
        if (posProp) { var pos = posProp.value; if (pos instanceof Array && pos.length >= 2) { pos[0] -= offsetX; pos[1] -= offsetY; posProp.setValue(pos); } }
    }
    comp.width = newWidth; comp.height = newHeight;
    app.endUndoGroup();
}

// --- UNUSED CLEANER ---
$._TheGlez.runUnusedCleaner = function() {
    if (!app || !app.project) return;
    var dlg = new Window("dialog", "Unused Cleaner"); dlg.orientation = "column"; dlg.alignChildren = "left"; dlg.margins = 12;
    dlg.add("statictext", undefined, "Plug-in By The Glez");
    var grpWhat = dlg.add("panel", undefined, "Targets"); grpWhat.orientation = "column"; grpWhat.alignChildren = "left";
    var chkPrecomps = grpWhat.add("checkbox", undefined, "Unused pre-comps"); chkPrecomps.value = true;
    var chkFootage = grpWhat.add("checkbox", undefined, "Unused footage"); chkFootage.value = true;
    var grpAction = dlg.add("panel", undefined, "Action"); grpAction.orientation = "column"; grpAction.alignChildren = "left";
    var rMove = grpAction.add("radiobutton", undefined, "Move to 04 - Others / _Unused"); rMove.value = true;
    var rDel = grpAction.add("radiobutton", undefined, "Delete from project");
    var grpButtons = dlg.add("group"); grpButtons.alignment = "right"; grpButtons.add("button", undefined, "OK", { name: "ok" }); grpButtons.add("button", undefined, "Cancel", { name: "cancel" });
    if (dlg.show() !== 1) return;

    var proj = app.project; var usedMap = {};
    for (var c = 1; c <= proj.numItems; c++) { var it = proj.item(c); if(it instanceof CompItem){ for(var l=1; l<=it.numLayers; l++){ try{var s=it.layer(l).source; if(s) usedMap[s.id]=true;}catch(e){} } } }
    function getOrCreateFolder(name, parent) { if(!parent) parent=proj.rootFolder; for(var i=1; i<=proj.numItems; i++){ var x=proj.item(i); if(x instanceof FolderItem && x.parentFolder===parent && x.name===name) return x;} var n=proj.items.addFolder(name); n.parentFolder=parent; return n; }
    
    app.beginUndoGroup("Clean Unused");
    var unusedFolder = rMove.value ? getOrCreateFolder("_Unused", getOrCreateFolder("04 - Others")) : null;
    var count = 0;
    var items = []; for(var i=1; i<=proj.numItems; i++) items.push(proj.item(i));
    for(var j=0; j<items.length; j++){
        var item=items[j]; if(item instanceof FolderItem) continue;
        var isUsed = !!usedMap[item.id];
        var process = false;
        if(chkPrecomps.value && item instanceof CompItem && !isUsed && item.parentFolder !== proj.rootFolder) process=true;
        if(chkFootage.value && !(item instanceof CompItem) && !isUsed) process=true;
        if(process){ if(rMove.value) item.parentFolder = unusedFolder; else try{item.remove();}catch(e){} count++; }
    }
    app.endUndoGroup(); alert("Processed " + count + " items.");
}

// --- RENAMER ---
$._TheGlez.runRenamer = function() {
    if (!app || !app.project) return;
    var comp = app.project.activeItem; if (!comp || !comp.selectedLayers || comp.selectedLayers.length === 0) { alert("Select layers."); return; }
    var dlg = new Window("dialog", "Renamer"); dlg.orientation = "column"; dlg.alignChildren = "left";
    dlg.add("statictext", undefined, "Plug-in By The Glez");
    var grpPrefix = dlg.add("group"); grpPrefix.add("statictext", undefined, "Prefix:"); var txtPrefix = grpPrefix.add("edittext", undefined, ""); txtPrefix.characters = 10;
    var grpBase = dlg.add("group"); grpBase.add("statictext", undefined, "Name:"); var txtBase = grpBase.add("edittext", undefined, ""); txtBase.characters = 10;
    var grpSuffix = dlg.add("group"); grpSuffix.add("statictext", undefined, "Suffix:"); var txtSuffix = grpSuffix.add("edittext", undefined, ""); txtSuffix.characters = 10;
    var chkNum = dlg.add("checkbox", undefined, "Numbering"); chkNum.value = true;
    var grpBtns = dlg.add("group"); grpBtns.add("button", undefined, "OK", {name:"ok"}); grpBtns.add("button", undefined, "Cancel", {name:"cancel"});
    if (dlg.show() !== 1) return;

    app.beginUndoGroup("Renamer");
    var layers = comp.selectedLayers;
    var sorted = []; for(var i=0; i<layers.length; i++) sorted.push(layers[i]);
    sorted.sort(function(a,b){ return a.index - b.index; });
    for(var i=0; i<sorted.length; i++){
        var name = ""; if(txtPrefix.text) name += txtPrefix.text; if(txtBase.text) name += txtBase.text;
        if(chkNum.value) { var n = (i+1).toString(); while(n.length<2) n="0"+n; name += n; }
        if(txtSuffix.text) name += txtSuffix.text;
        if(name !== "") sorted[i].name = name;
    }
    app.endUndoGroup();
}

// --- ORGANIZER ---
$._TheGlez.runOrganizer = function() {
    (function () {
        if (!app || !app.project) {
            alert("No project open.");
            return;
        }

        var proj       = app.project;
        var rootFolder = proj.rootFolder;

        // Collect all comps
        var compItems = [];
        for (var i = 1; i <= proj.numItems; i++) {
            var it = proj.item(i);
            if (it instanceof CompItem) {
                compItems.push(it);
            }
        }

        var keepUserFolders = true;
        var useMaster       = false;
        var masterComp      = null;
        var presetAdvanced  = false;

        if (compItems.length > 0) {
            var compNames = [];
            for (var c = 0; c < compItems.length; c++) {
                compNames.push(compItems[c].name);
            }

            var dlg = new Window("dialog", "Project Organizer");
            dlg.orientation   = "column";
            dlg.alignChildren = "left";
            dlg.margins       = 12;

            var headline = dlg.add("statictext", undefined, "Plug-in By The Glez");
            headline.characters = 30;

            dlg.add("statictext", undefined, "Choose how you want to organize the project:");

            var grpPreset = dlg.add("group");
            grpPreset.orientation = "row";
            grpPreset.add("statictext", undefined, "Preset:");
            var ddPreset = grpPreset.add("dropdownlist", undefined, ["Basic (default)", "Advanced (sequences + renders folder)"]);
            ddPreset.selection = 0;

            var grpKeep = dlg.add("group");
            grpKeep.orientation = "row";
            var chkKeep = grpKeep.add("checkbox", undefined, "Keep existing folders (donâ€™t move items inside them)");
            chkKeep.value = true;

            var grpMasterToggle = dlg.add("group");
            grpMasterToggle.orientation = "row";
            var chkMaster = grpMasterToggle.add("checkbox", undefined, "Use Master Comp (Output)");
            chkMaster.value = false;

            var grpComp = dlg.add("group");
            grpComp.orientation = "row";
            grpComp.add("statictext", undefined, "Master Comp:");
            var ddComp = grpComp.add("dropdownlist", undefined, compNames);
            ddComp.minimumSize.width = 260;
            ddComp.enabled = false;
            ddComp.selection = 0;

            chkMaster.onClick = function () {
                ddComp.enabled = chkMaster.value;
            };

            var grpButtons = dlg.add("group");
            grpButtons.alignment = "right";
            grpButtons.add("button", undefined, "OK",     { name: "ok" });
            grpButtons.add("button", undefined, "Cancel", { name: "cancel" });

            var res = dlg.show();
            if (res !== 1) {
                return; // cancelled
            }

            keepUserFolders = chkKeep.value;
            useMaster       = chkMaster.value;
            presetAdvanced  = (ddPreset.selection && ddPreset.selection.index === 1);

            if (useMaster && ddComp.selection) {
                masterComp = compItems[ddComp.selection.index];
            }

        } else {
            var cont = confirm("No compositions found in this project.\\n\\nDo you want to continue and just organize media by type?");
            if (!cont) return;
        }

        app.beginUndoGroup("Organize project by file type - The Glez");

        function getOrCreateFolder(name, parentFolder) {
            if (!parentFolder) parentFolder = rootFolder;
            for (var i = 1; i <= proj.numItems; i++) {
                var it = proj.item(i);
                if (it instanceof FolderItem && it.parentFolder === parentFolder && it.name === name) {
                    return it;
                }
            }
            var newFolder = proj.items.addFolder(name);
            newFolder.parentFolder = parentFolder;
            return newFolder;
        }

        var masterCompFolder = null;
        if (masterComp) {
            masterCompFolder = getOrCreateFolder("01 - Master Comp (Output)", rootFolder);
        }

        var preCompsFolder = getOrCreateFolder("02 - Pre-Comps", rootFolder);
        var footageRoot    = getOrCreateFolder("03 - Footage",   rootFolder);

        var imagesFolder   = getOrCreateFolder("3.1 - Images (Stills)", footageRoot);
        var videosFolder   = getOrCreateFolder("3.2 - Video",           footageRoot);
        var audioFolder    = getOrCreateFolder("3.3 - Audio",           footageRoot);
        var miscFootage    = getOrCreateFolder("3.4 - Misc",            footageRoot);

        var imgSeqFolder   = null;
        if (presetAdvanced) {
            imgSeqFolder = getOrCreateFolder("3.5 - Image Sequences", footageRoot);
        }

        var othersRoot     = getOrCreateFolder("04 - Others", rootFolder);
        var rendersRoot    = null;
        if (presetAdvanced) {
            rendersRoot = getOrCreateFolder("05 - Renders", rootFolder);
        }

        var specialFolders = [preCompsFolder, footageRoot, imagesFolder, videosFolder, audioFolder, miscFootage, othersRoot];
        if (masterCompFolder) specialFolders.push(masterCompFolder);
        if (imgSeqFolder) specialFolders.push(imgSeqFolder);
        if (rendersRoot) specialFolders.push(rendersRoot);

        function isSpecialFolder(item) {
            for (var i = 0; i < specialFolders.length; i++) {
                if (item === specialFolders[i]) return true;
            }
            return false;
        }

        var items = [];
        for (var i = 1; i <= proj.numItems; i++) {
            items.push(proj.item(i));
        }

        function getExtensionFromName(name) {
            name = name.toLowerCase();
            var dot = name.lastIndexOf(".");
            if (dot < 0 || dot === name.length - 1) return "";
            return name.substring(dot + 1);
        }

        function isImageSequenceName(name) {
            var lower = name.toLowerCase();
            var dot   = lower.lastIndexOf(".");
            if (dot < 0) return false;
            var base  = lower.substring(0, dot);
            var m = base.match(/(\d{3,6})$/);
            return m !== null;
        }

        var imageExts = { "jpg":1, "jpeg":1, "png":1, "tif":1, "tiff":1, "psd":1, "exr":1, "hdr":1, "tga":1, "bmp":1, "gif":1, "dpx":1, "cin":1, "webp":1 };
        var videoExts = { "mov":1, "mp4":1, "m4v":1, "avi":1, "mxf":1, "mkv":1, "mts":1, "m2ts":1, "wmv":1, "flv":1, "mpeg":1, "mpg":1 };
        var audioExts = { "wav":1, "aif":1, "aiff":1, "mp3":1, "m4a":1, "ogg":1 };

        for (var j = 0; j < items.length; j++) {
            var item = items[j];
            if (isSpecialFolder(item)) continue;
            if (keepUserFolders && item.parentFolder !== rootFolder) continue;
            if (masterComp && item === masterComp && masterCompFolder) {
                item.parentFolder = masterCompFolder;
                continue;
            }
            if (item instanceof FolderItem) continue;

            if (item instanceof CompItem) {
                item.parentFolder = preCompsFolder;
                continue;
            }

            var ext = getExtensionFromName(item.name);

            if (audioExts[ext]) {
                item.parentFolder = audioFolder;
                continue;
            }

            if (imageExts[ext]) {
                if (presetAdvanced && imgSeqFolder && isImageSequenceName(item.name)) {
                    item.parentFolder = imgSeqFolder;
                } else {
                    item.parentFolder = imagesFolder;
                }
                continue;
            }

            if (videoExts[ext]) {
                item.parentFolder = videosFolder;
                continue;
            }

            if (ext === "") {
                item.parentFolder = othersRoot;
            } else {
                item.parentFolder = miscFootage;
            }
        }

        app.endUndoGroup();

    })();
}

// --- AUTO COLOR ---
$._TheGlez.runAutoColor = function() {
    (function () {
        if (!app || !app.project) {
            alert("No project open.");
            return;
        }

        var proj = app.project;
        var comp = proj.activeItem;

        if (!(comp instanceof CompItem)) {
            alert("Please select a composition.");
            return;
        }

        if (!comp.selectedLayers || comp.selectedLayers.length === 0) {
            alert("Please select at least one layer in the active composition.");
            return;
        }

        var selLayers = comp.selectedLayers;

        // ------------------------------------------------
        // Label choices (AE default label set)
        // ------------------------------------------------
        var labelChoices = [
            { name: "No change", value: 0 },
            { name: "1 - Red",      value: 1 },
            { name: "2 - Yellow",   value: 2 },
            { name: "3 - Aqua",     value: 3 },
            { name: "4 - Pink",     value: 4 },
            { name: "5 - Lavender", value: 5 },
            { name: "6 - Peach",    value: 6 },
            { name: "7 - Seafoam",  value: 7 },
            { name: "8 - Blue",     value: 8 },
            { name: "9 - Green",    value: 9 },
            { name: "10 - Purple",  value: 10 },
            { name: "11 - Orange",  value: 11 },
            { name: "12 - Brown",   value: 12 },
            { name: "13 - Fuchsia", value: 13 },
            { name: "14 - Cyan",    value: 14 },
            { name: "15 - Sand",    value: 15 },
            { name: "16 - Smoke",   value: 16 }
        ];

        function createLabelDropdown(parent, label, defaultValue) {
            var g = parent.add("group");
            g.orientation = "row";
            g.add("statictext", undefined, label);

            var names = [];
            for (var i = 0; i < labelChoices.length; i++) {
                names.push(labelChoices[i].name);
            }

            var dd = g.add("dropdownlist", undefined, names);
            dd.minimumSize.width = 180;

            var defaultIndex = 0;
            for (var j = 0; j < labelChoices.length; j++) {
                if (labelChoices[j].value === defaultValue) {
                    defaultIndex = j;
                    break;
                }
            }
            dd.selection = defaultIndex;
            return dd;
        }

        // ------------------------------------------------
        // UI: Dialog
        // ------------------------------------------------
        var dlg = new Window("dialog", "Auto Type Color & Prefix");
        dlg.orientation   = "column";
        dlg.alignChildren = "left";
        dlg.margins       = 12;

        var headline = dlg.add("statictext", undefined, "Plug-in By The Glez");
        headline.characters = 30;

        dlg.add("statictext", undefined, "Choose label colors for each layer type:");

        var panelColors = dlg.add("panel", undefined, "Label colors by type");
        panelColors.orientation   = "column";
        panelColors.alignChildren = "left";
        panelColors.margins       = 10;

        var ddCam   = createLabelDropdown(panelColors, "Camera:",        4);  // Pink
        var ddLight = createLabelDropdown(panelColors, "Light:",         6);  // Peach
        var ddAud   = createLabelDropdown(panelColors, "Audio:",         7);  // Seafoam
        var ddPC    = createLabelDropdown(panelColors, "Pre-comp:",      15); // Sand (Composition)
        var ddVid   = createLabelDropdown(panelColors, "Footage Video:", 3);  // Aqua
        var ddImg   = createLabelDropdown(panelColors, "Footage Still:", 5);  // Lavender
        var ddTxt   = createLabelDropdown(panelColors, "Text:",          1);  // Red
        var ddShp   = createLabelDropdown(panelColors, "Shape:",         8);  // Blue
        var ddNull  = createLabelDropdown(panelColors, "Null:",          1);  // Red
        var ddAdj   = createLabelDropdown(panelColors, "Adjustment:",    5);  // Lavender
        var ddOth   = createLabelDropdown(panelColors, "Other:",         2);  // Yellow

        var panelOpts = dlg.add("panel", undefined, "Options");
        panelOpts.orientation   = "column";
        panelOpts.alignChildren = "left";
        panelOpts.margins       = 10;

        var grpPrefix = panelOpts.add("group");
        grpPrefix.orientation = "row";
        var chkAddPrefix = grpPrefix.add("checkbox", undefined, "Prepend type prefix to layer names");
        chkAddPrefix.value = true;

        var grpButtons = dlg.add("group");
        grpButtons.alignment = "right";
        grpButtons.add("button", undefined, "OK",     { name: "ok" });
        grpButtons.add("button", undefined, "Cancel", { name: "cancel" });

        var res = dlg.show();
        if (res !== 1) {
            return; // user cancelled
        }

        // ------------------------------------------------
        // Read label choices
        // ------------------------------------------------
        function getLabelFromDropdown(dd) {
            var idx = dd.selection ? dd.selection.index : 0;
            return labelChoices[idx].value;
        }

        var lblCam   = getLabelFromDropdown(ddCam);
        var lblLight = getLabelFromDropdown(ddLight);
        var lblAud   = getLabelFromDropdown(ddAud);
        var lblPC    = getLabelFromDropdown(ddPC);
        var lblVid   = getLabelFromDropdown(ddVid);
        var lblImg   = getLabelFromDropdown(ddImg);
        var lblTxt   = getLabelFromDropdown(ddTxt);
        var lblShp   = getLabelFromDropdown(ddShp);
        var lblNull  = getLabelFromDropdown(ddNull);
        var lblAdj   = getLabelFromDropdown(ddAdj);
        var lblOth   = getLabelFromDropdown(ddOth);

        var addPrefix = chkAddPrefix.value;

        // ------------------------------------------------
        // Prefix map
        // ------------------------------------------------
        var prefixMap = {
            camera:    "CAM - ",
            light:     "LGT - ",
            audio:     "AUD - ",
            precomp:   "PC - ",
            footVideo: "VID - ",
            footStill: "IMG - ",
            text:      "TXT - ",
            shape:     "SHP - ",
            "null":    "NULL - ",
            adjust:    "ADJ - ",
            other:     "OTH - "
        };

        // ------------------------------------------------
        // Helpers
        // ------------------------------------------------
        function isTextLayer(layer) {
            try {
                var st = layer.property("Source Text");
                return (st !== null && st !== undefined);
            } catch (e) {
                return false;
            }
        }

        function isShapeLayer(layer) {
            try {
                var grp = layer.property("ADBE Root Vectors Group");
                return (grp !== null && grp !== undefined);
            } catch (e) {
                return false;
            }
        }

        function isCameraLayer(layer) {
            try {
                if (layer instanceof CameraLayer) {
                    return true;
                }
            } catch (e) {
                try {
                    var camOpts = layer.property("ADBE Camera Options Group");
                    if (camOpts !== null && camOpts !== undefined) {
                        return true;
                    }
                } catch (e2) {}
            }
            return false;
        }

        function isLightLayer(layer) {
            try {
                if (layer instanceof LightLayer) {
                    return true;
                }
            } catch (e) {
                try {
                    var lgtOpts = layer.property("ADBE Light Options Group");
                    if (lgtOpts !== null && lgtOpts !== undefined) {
                        return true;
                    }
                } catch (e2) {}
            }
            return false;
        }

        function isAudioOnlyLayer(layer) {
            try {
                return (layer.hasAudio && !layer.hasVideo);
            } catch (e) {}
            return false;
        }

        function getSource(layer) {
            try {
                return layer.source;
            } catch (e) {
                return null;
            }
        }

        function isPrecompLayer(layer) {
            var src = getSource(layer);
            if (!src) return false;
            return (src instanceof CompItem);
        }

        function getExtensionFromName(name) {
            name = name.toLowerCase();
            var dot = name.lastIndexOf(".");
            if (dot < 0 || dot === name.length - 1) return "";
            return name.substring(dot + 1);
        }

        var imageExts = {
            "jpg":1, "jpeg":1, "png":1, "tif":1, "tiff":1,
            "psd":1, "exr":1, "hdr":1, "tga":1, "bmp":1,
            "gif":1, "dpx":1, "cin":1, "webp":1
        };

        var videoExts = {
            "mov":1, "mp4":1, "m4v":1, "avi":1, "mxf":1,
            "mkv":1, "mts":1, "m2ts":1, "wmv":1, "flv":1,
            "mpeg":1, "mpg":1
        };

        function classifyFootage(layer) {
            var src = getSource(layer);
            if (!src) return null;

            var name = src.name || layer.name;
            var ext  = getExtensionFromName(name);

            if (imageExts[ext]) return "footStill";
            if (videoExts[ext]) return "footVideo";

            return "footOther";
        }

        function startsWithPrefix(name, prefix) {
            if (!prefix || prefix === "") return false;
            if (!name) return false;
            if (name.length < prefix.length) return false;
            var start = name.substring(0, prefix.length);
            return start === prefix;
        }

        // ------------------------------------------------
        // Main logic
        // ------------------------------------------------
        app.beginUndoGroup("Auto Type Color & Prefix - The Glez");

        for (var k = 0; k < selLayers.length; k++) {
            var lyr = selLayers[k];

            var category = null;

            // Priority: camera, light, audio, text, shape, null, adjust, precomp, footage, other
            if (!category && isCameraLayer(lyr)) {
                category = "camera";
            }

            if (!category && isLightLayer(lyr)) {
                category = "light";
            }

            if (!category && isAudioOnlyLayer(lyr)) {
                category = "audio";
            }

            if (!category && isTextLayer(lyr)) {
                category = "text";
            }

            if (!category && isShapeLayer(lyr)) {
                category = "shape";
            }

            if (!category && lyr.nullLayer === true) {
                category = "null";
            }

            if (!category && lyr.adjustmentLayer === true) {
                category = "adjust";
            }

            if (!category && isPrecompLayer(lyr)) {
                category = "precomp";
            }

            if (!category) {
                var ftCat = classifyFootage(lyr);
                if (ftCat === "footVideo") {
                    category = "footVideo";
                } else if (ftCat === "footStill") {
                    category = "footStill";
                }
            }

            if (!category) {
                category = "other";
            }

            // Label por tipo
            var chosenLabel = 0;
            switch (category) {
                case "camera":    chosenLabel = lblCam;   break;
                case "light":     chosenLabel = lblLight; break;
                case "audio":     chosenLabel = lblAud;   break;
                case "precomp":   chosenLabel = lblPC;    break;
                case "footVideo": chosenLabel = lblVid;   break;
                case "footStill": chosenLabel = lblImg;   break;
                case "text":      chosenLabel = lblTxt;   break;
                case "shape":     chosenLabel = lblShp;   break;
                case "null":      chosenLabel = lblNull;  break;
                case "adjust":    chosenLabel = lblAdj;   break;
                case "other":     chosenLabel = lblOth;   break;
            }

            if (chosenLabel > 0) {
                lyr.label = chosenLabel;
            }

            // Prefixo
            if (addPrefix) {
                var prefix = prefixMap[category];
                if (prefix && prefix.length > 0) {
                    var originalName = lyr.name;
                    if (!startsWithPrefix(originalName, prefix)) {
                        lyr.name = prefix + originalName;
                    }
                }
            }
        }

        app.endUndoGroup();

    })();
}`
};